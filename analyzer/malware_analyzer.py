__author__ = "zqzas"
#from core.engine import Analyzer
#from core.tags import Tags
from cuckoo_wrapper import CuckooWrapper

#Malware = Tags.Malware


# For tags one may use array as well, both of them accepted.
#@Analyzer(tags=Malware)
class MalwareAnalyzer:
    """ Malware Analyzer Using Cuckoo """

    def __init__(self):
        self.cuckoo = CuckooWrapper()

    def __repr__(self):
        return "MalwareAnalyzer"

    def analyze(self, data, path = None):
        """
        Analyze the data
        @param data     : the data object
        @param path     : the location of the malware data in filesystem, default None.
        @return         : the task id
        """

        def retrievePath(data):
            """ get the path of data """
            pass

        if path == None:
            path = retrievePath(data)

        try:
            taskID = self.cuckoo.analyzeMalware(path)
        except:
            #raise proper Exception here
            raise Exception("Malware Analyzer Fails.")

        return taskID




